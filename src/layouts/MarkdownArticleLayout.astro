---
import BaseLayout from "./BaseLayout.astro";
import { Article } from "../models/Article";
import Image from "astro/components/Image.astro";

const raw = (Astro.props as any).frontmatter ?? Astro.props;
const article = new Article(raw);

const formattedDate = article.formattedDate;
const cover = article.imageUrl;
const coverAlt = article.imageAlt;

/** @type {string[]} */
const tags = article.tags ?? [];
---


<BaseLayout pageTitle={article.title}>
    <article class="post-card">
        {cover ? (
            <figure class="post-cover">
                <Image src={cover} alt={coverAlt} inferSize={true} />
            </figure>
        ) : null}

        <header class="post-hero">
            <h1>{article.title}</h1>
            <div class="meta">
                <span class="meta-author">Par {article.author}</span>
                <span class="meta-sep">·</span>
                <time class="meta-date">{formattedDate}</time>
            </div>
            {article.description ? <p class="excerpt">{article.description}</p> : null}

            {tags.length ? (
                <div class="tags" aria-hidden="true">{tags.join(' · ')}</div>
            ) : null}
        </header>

        <section class="post-content">
            <slot />
        </section>

        <footer class="post-footer">
            <a href="/articles/">Retour à la liste des articles</a>
        </footer>
    </article>
</BaseLayout>

<style>
    .post-card {
        max-width: 800px;
        margin: 0 auto;
        padding: 1rem;
    }

    .post-cover img {
        width: 100%;
        height: auto;
        border-radius: 8px;
        margin-bottom: 1rem;
    }

    .post-hero {
        margin-bottom: 2rem;
    }

    .meta {
        font-size: 0.9rem;
        color: var(--color-text-secondary);
        margin-bottom: 0.5rem;
    }

    .meta-sep {
        margin: 0 0.5rem;
    }

    .excerpt {
        font-style: italic;
        margin-bottom: 1rem;
    }

    .tags {
        margin-top: 0.5rem;
        font-size: 0.9rem;
        color: var(--color-text-secondary);
    }

    .post-content {
        line-height: 1.6;
    }

    .post-footer {
        margin-top: 3rem;
        font-size: 0.9rem;
    }

    .post-footer a {
        text-decoration: none;
        font-weight: 600;
        color: var(--primary-color);
    }

    .post-footer a:hover {
        text-decoration: underline;
    }

    .meta-author {
        font-size: 0.9rem;
        color: var(--color-text-secondary);
    }
    .meta-date {
        font-size: 0.9rem;
        color: var(--color-text-secondary);
    }
</style>
