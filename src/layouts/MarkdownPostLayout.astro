---
import BaseLayout from "./BaseLayout.astro";
const { frontmatter } = Astro.props;

const formattedDate = frontmatter.pubDate
    ? new Date(frontmatter.pubDate).toLocaleDateString('fr-FR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
        })
    : '';

const cover = frontmatter.image && (frontmatter.image.url || frontmatter.image);
const coverAlt = frontmatter.image && frontmatter.image.alt ? frontmatter.image.alt : frontmatter.title;

/** @type {string[]} */
const tags = Array.isArray(frontmatter.tags) ? frontmatter.tags : [];
---


<BaseLayout pageTitle={frontmatter.title}>
    <article class="post-card">
        {cover ? (
            <figure class="post-cover">
                <img src={cover} alt={coverAlt} />
            </figure>
        ) : null}

        <header class="post-hero">
            <h1>{frontmatter.title}</h1>
            <div class="meta">
                <span class="meta-author">Par {frontmatter.author}</span>
                <span class="meta-sep">·</span>
                <time class="meta-date">{formattedDate}</time>
            </div>
            {frontmatter.description ? <p class="excerpt">{frontmatter.description}</p> : null}

            {tags.length ? (
                <div class="tags" aria-hidden="true">{tags.join(' · ')}</div>
            ) : null}
        </header>

        <section class="post-content">
            <slot />
        </section>
    </article>
</BaseLayout>

<style>
    .post-card {
        max-width: 920px;
        margin: 2rem auto;
        padding: 0;
        background: white;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(16,24,40,0.06);
        overflow: hidden;
    }

    .post-hero {
        padding: 2.25rem 1.25rem;
        border-bottom: 1px solid var(--border-color);
        background: linear-gradient(180deg, rgba(52,152,219,0.04), transparent 60%);
    }

    .post-hero h1 {
        font-size: 2rem;
        line-height: 1.15;
        margin: 0 0 0.5rem 0;
    }

    .meta {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        color: var(--text-secondary-color);
        font-size: 0.95rem;
    }

    .post-content {
        padding: 1.5rem 1.5rem 2.25rem 1.5rem;
        line-height: 1.75;
        color: var(--text-color);
    }

    .post-content img {
        max-width: 100%;
        border-radius: 8px;
        display: block;
        margin: 1rem auto;
    }

    .post-content pre {
        background: #0f172a;
        color: #e6edf3;
        padding: 1rem;
        border-radius: 8px;
        overflow: auto;
    }

    .post-content blockquote {
        border-left: 4px solid var(--primary-color);
        padding-left: 1rem;
        color: var(--text-secondary-color);
        margin: 1rem 0;
        font-style: italic;
    }

    /* post cover */
    .post-cover img {
        width: 100%;
        height: 320px;
        object-fit: cover;
        display: block;
    }

    .excerpt {
        margin-top: 0.75rem;
        color: var(--text-secondary-color);
    }

    .tags {
        margin-top: 0.75rem;
        color: var(--primary-color);
        font-weight: 600;
    }
</style>
